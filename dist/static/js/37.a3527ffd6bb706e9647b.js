webpackJsonp([37],{190:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(57),i=r(22),s=r(171),o=r(23),n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e};t.default={props:["openCreditDialog","creditCardOption","totalAmountPayble","redeemedAmountPayble","superPNR"],components:{LoaderView:function(){return r.e(15).then(r.bind(null,170))},paymentError:function(){return r.e(16).then(r.bind(null,172))}},computed:n({},r.i(a.b)({getUserInfo:i.j})),data:function(){return{responseCheck:!1,responseMessage:"",address:"",city:"",state_code:"",pin_code:"",number:"",selectedTelephoneCode:"+91",phone:"",cardAddressErrorMsg:void 0,cardCityErrorMsg:void 0,cardStateErrorMsg:void 0,cardPinErrorMsg:void 0,cardPhoneErrorMsg:void 0,isInternationalCard:!1,cardCVVErrorMsg:void 0,cardExpiryDateErrorMsg:void 0,cardNumberErrorMsg:void 0,cardHolderErrorMsg:void 0,creditDialog:!1,CreditVisible:!0,cardImg:"",timeout:1500,y:"bottom",totalPrice:0,productCode:"pwa_bus",redeemedamount:0,submited:!1,ajaxLoadingDialog:!1,selectedCardForValidation:!1,cardMaxLength:"3",selectedCard:{},orderResponse:{},createOrderResponse:{},paymentOpt:{CreditCardDetails:{number:"",name:"",mm:"",yy:"",cvv:"",payop:"cc"}},Card_rules:{required:function(e){return!!e||"Card is required"},patternValidation:function(e){return/^[0-9]*$/.test(e)||"Enter valid Card Number"}},showLoader:!1,paymentErrorMessage:{},showPaymentDialog:!1}},created:function(){this.createOrderResponse=this.superPNR},watch:{openCreditDialog:function(){this.creditDialog=this.openCreditDialog,this.totalPrice=this.totalAmountPayble,this.redeemedamount=this.redeemedAmountPayble,this.openCreditDialog&&(this.createOrderResponse=this.superPNR,this.selectedCardForValidation=!1,this.cardImg="",this.paymentOpt={CreditCardDetails:{number:"",name:"",mm:"",yy:"",cvv:"",payop:"cc"}})},number:function(e){this.paymentOpt.CreditCardDetails.number=this.number;var t=JSON.parse(localStorage.getItem("busReviewRequest"));this.paymentOpt.CreditCardDetails.number,this.productCode,t.superPNR}},methods:{navigateToSrp:function(){o.a.push({name:"BusSRP"})},checkMonthLength:function(){2==this.paymentOpt.CreditCardDetails.mm.length&&this.$refs.expiryYrs.focus()},closeCreditDialog:function(){this.$emit("closeCreditDialog",!1)},validateCardRegex:function(e){return new RegExp(e.cardValidations.regex).test(this.paymentOpt.CreditCardDetails.number.replace(/\s/g,""))},checkCardDetails:function(){var e=this.creditCardOption.cardTypes.findIndex(this.validateCardRegex);e>=0?(this.selectedCard=this.creditCardOption.cardTypes[e].cardValidations,this.cardMaxLength=this.selectedCard.cvvLength,this.selectedCardForValidation=!0,this.cardImg=this.creditCardOption.cardTypes[e].logoURL):(this.cardMaxLength="3",this.selectedCardForValidation=!1,this.cardImg="")},validateName:function(){if(""==this.paymentOpt.CreditCardDetails.name){this.cardHolderErrorMsg="Enter Card Holder Name";var e=this;return setTimeout(function(){e.cardHolderErrorMsg=void 0},2e3),!1}return this.cardHolderErrorMsg=void 0,!0},validateExpiryDate:function(){if(this.cardExpiryDateErrorMsg=""==this.paymentOpt.CreditCardDetails.mm||parseInt(this.paymentOpt.CreditCardDetails.mm)>12||""==this.paymentOpt.CreditCardDetails.yy?"Invalid Expiry Date":parseInt(this.paymentOpt.CreditCardDetails.yy)>parseInt((new Date).getFullYear().toString().substr(-2))?void 0:parseInt(this.paymentOpt.CreditCardDetails.yy)==parseInt((new Date).getFullYear().toString().substr(-2))&&parseInt(this.paymentOpt.CreditCardDetails.mm)>parseInt(("0"+((new Date).getMonth()+1)).slice(-2))?void 0:"Invalid Expiry Date",void 0==this.cardExpiryDateErrorMsg)return!0;var e=this;return setTimeout(function(){e.cardExpiryDateErrorMsg=void 0},2e3),!1},validateCVV:function(){if(this.selectedCard.cvv&&"optional"==this.selectedCard.cvv)return!0;if(this.cardCVVErrorMsg=""==this.paymentOpt.CreditCardDetails.cvv?"Enter CVV number":parseInt(this.paymentOpt.CreditCardDetails.cvv)>=0&&this.paymentOpt.CreditCardDetails.cvv.length===parseInt(this.selectedCard.cvvLength)?void 0:"Enter Correct CVV no",void 0==this.cardCVVErrorMsg)return!0;var e=this;return setTimeout(function(){e.cardCVVErrorMsg=void 0},2e3),!1},submitPay:function(){if(!this.selectedCardForValidation){this.cardNumberErrorMsg="Enter correct card details";var e=this;return setTimeout(function(){e.cardNumberErrorMsg=void 0},2e3),!1}if(this.cardNumberErrorMsg=void 0,!(this.validateName()&&this.validateExpiryDate()&&this.validateCVV()))return!1;this.paySwiftCall()},paySwiftCall:function(){var e=this;this.showLoader=!0;var t=JSON.parse(localStorage.getItem("userInfo")),a=JSON.parse(localStorage.getItem("busReviewRequest")),i=localStorage.getItem("departDate"),o=this.creditCardOption.cardTypes.findIndex(this.validateCardRegex),n={patternMatch:new RegExp("^[1-9][0-9]?$"),paymentModeType:"",paymentAmount:this.totalPrice-this.redeemedamount,tdate:i,cno:this.paymentOpt.CreditCardDetails.number.replace(/\s/g,""),cardType:this.creditCardOption.cardTypes[o].code,cardHolderName:this.paymentOpt.CreditCardDetails.name,cardHolderNumber:this.paymentOpt.CreditCardDetails.number,cardMM:this.paymentOpt.CreditCardDetails.mm,cardYY:this.paymentOpt.CreditCardDetails.yy,cardCvv:this.paymentOpt.CreditCardDetails.cvv,payOptionType:this.paymentOpt.CreditCardDetails.payop,productCode:this.productCode},d={amountDisplayed:n.paymentAmount,eCashRedemed:this.redeemedamount,appVersion:"1.0",client:"APP",discount:0,discountingStatus:!1,email:t.email,merchant:"yatra",mob:t.mobile,otherDiscountingStatus:!1,paymentMode:"FULL",paymentOptionParameters:"tdate="+n.tdate+"|merchant=yatra|product="+n.productCode+"|payop="+n.payOptionType+"|previousPayOp="+n.payOptionType+"|cno="+n.cno+"|ctype="+n.cardType+"|isCardInternational=false|address_check_rdo=Domestic|cardholder_name="+n.cardHolderName+"|cexpy=20"+n.cardYY+"|cexpm="+n.cardMM+"|ccsc="+n.cardCvv+"|client=APP|uuid="+localStorage.getItem("UUID"),product:n.productCode,promoCode:JSON.parse(localStorage.getItem("promoCodePayment")).code||"",promoType:JSON.parse(localStorage.getItem("promoCodePayment")).type||"",superPnr:a.superPNR,ttid:parseInt("11"+a.superPNR),uuid:localStorage.getItem("UUID"),amountToRedeem:this.redeemedamount};Vue.http.options.emulateJSON=!0,this.$http.post("https://www.yatra.com/PaySwift/payNow",d).then(function(t){console.log("pay now response is "+t),e.showLoader=!1,t.body&&t.body.rurl?r.i(s.a)(t.body):t.body&&Object.keys(t.body.redirectMap)?(e.paymentErrorMessage=t.body.redirectMap.errMsg||"Oops, we seem to have temporary hiccup. We apologise for the inconvenience caused and request you to try again.",e.showPaymentDialog=!0):e.navigateToSrp()}).catch(function(t){e.showLoader=!1,e.showPaymentDialog=!1,setTimeout(function(){e.paymentErrorMessage="Oops, we seem to have temporary hiccup. We apologise for the inconvenience caused and request you to try again.",e.showPaymentDialog=!0},2e3)})},cardSpace:function(e){e=e||window.event;var t=e.which?e.which:e.keyCode;if(!(t>31&&(t<48||t>57)||this.paymentOpt.CreditCardDetails.number.replace(/\s/g,"").length>=19)){var r=this.paymentOpt.CreditCardDetails.number.replace(/\s/g,"");return 0!=r.length&&r.length%4==0&&(this.paymentOpt.CreditCardDetails.number+=" "),!0}e.preventDefault()},onlyNumeric:function(e,t){var r=new RegExp("^[0-9]+$"),a=String.fromCharCode(event.charCode?event.charCode:event.which);if(!r.test(a))return event.preventDefault(),!1},checkCardPaste:function(e){var t=this;setTimeout(function(){t.number="",e.preventDefault(),e.stopPropagation()},10)}}}},238:function(e,t,r){t=e.exports=r(152)(!0),t.push([e.i,".cardui div:last-child:after,.cardui div:last-child:before{display:none}.errorMsg{margin-top:-2px;margin-bottom:5px;color:#f44336}.pricefixed{position:fixed;bottom:0;width:100%;text-align:center;background-color:#f44336;height:43px;font-size:14px;font-weight:700}.pricefixed .btn{font-size:14px;margin-top:5px;color:#fff}.img-res{right:20px;top:10px;width:14%;height:auto}.cvv{width:25%;top:11px;right:10px}","",{version:3,sources:["F:/bus/src/components/busPayment/CreditCard.vue"],names:[],mappings:"AACA,2DACI,YAAc,CACjB,AACD,UACI,gBAAgB,AAChB,kBAAkB,AAClB,aAAe,CAClB,AACD,YACA,eAAgB,AAChB,SAAU,AACV,WAAY,AACZ,kBAAmB,AACnB,yBAA0B,AAC1B,YAAa,AACb,eAAgB,AAChB,eAAkB,CACjB,AACD,iBACI,eAAe,AACf,eAAe,AACf,UAAY,CACf,AACD,SACI,WAAY,AACZ,SAAU,AACV,UAAW,AACX,WAAa,CAChB,AACD,KACI,UAAW,AACX,SAAU,AACV,UAAY,CACf",file:"CreditCard.vue",sourcesContent:["\n.cardui div:last-child:before, .cardui div:last-child:after {\n    display: none;\n}\n.errorMsg{\n    margin-top:-2px;\n    margin-bottom:5px;\n    color: #f44336;\n}\n.pricefixed {\nposition: fixed;\nbottom: 0;\nwidth: 100%;\ntext-align: center;\nbackground-color: #f44336;\nheight: 43px;\nfont-size: 14px;\nfont-weight: bold;\n}\n.pricefixed .btn{\n    font-size:14px;\n    margin-top:5px;\n    color: #fff;\n}\n.img-res {\n    right: 20px;\n    top: 10px;\n    width: 14%;\n    height: auto;\n}\n.cvv {\n    width: 25%;\n    top: 11px;\n    right: 10px;\n}\n"],sourceRoot:""}])},270:function(e,t,r){var a=r(238);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r(153)("78380b8e",a,!0,{})},289:function(e,t,r){function a(e){r(270)}var i=r(56)(r(190),r(322),a,null,null);e.exports=i.exports},322:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-dialog",{attrs:{fullscreen:"",transition:"dialog-bottom-transition",overlay:!1},model:{value:e.creditDialog,callback:function(t){e.creditDialog=t},expression:"creditDialog"}},[r("v-toolbar",{staticClass:"white cd_fixed_header",attrs:{dark:""}},[r("v-btn",{staticStyle:{"margin-left":"0px"},attrs:{icon:"",dark:""},nativeOn:{click:function(t){return e.closeCreditDialog(t)}}},[r("v-icon",{staticClass:"cl_white_back payment_back"},[e._v("arrow_back")])],1),e._v(" "),r("v-toolbar-title",{staticClass:"cd_header_white header_white"},[e._v("Credit Card")]),e._v(" "),r("v-spacer"),e._v(" "),r("v-toolbar-items",[r("v-btn",{attrs:{dark:"",flat:""},nativeOn:{click:function(t){return e.closeCreditDialog(t)}}})],1)],1),e._v(" "),e.CreditVisible?r("v-container",{staticClass:"p20 paycard bg-white",attrs:{id:"creditcard"}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs12:"",prel:""}},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.number,expression:"number"}],staticClass:"cardui",attrs:{id:"input1_cc",autocomplete:"off",name:"cc-number",placeholder:"Card Number"},domProps:{value:e.number},on:{paste:e.checkCardPaste,blur:e.checkCardDetails,keypress:function(t){e.cardSpace(t)},input:function(t){t.target.composing||(e.number=t.target.value)}}}),e._v(" "),""!=e.cardImg?r("img",{staticClass:"pabs img-res",attrs:{src:"/pwa/bus/static/img/icons/"+e.cardImg+".png"}}):e._e()]),e._v(" "),e.cardNumberErrorMsg?r("v-flex",{attrs:{xs12:"",errorMsg:""}},[e._v(e._s(e.cardNumberErrorMsg))]):e._e()],1),e._v(" "),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs12:""}},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.paymentOpt.CreditCardDetails.name,expression:"paymentOpt.CreditCardDetails.name"}],staticClass:"cardui",attrs:{id:"input2_cc",autocomplete:"off",autocapitalize:"none",autocorrect:"off",name:"name",tabindex:"0",placeholder:"Name On Card"},domProps:{value:e.paymentOpt.CreditCardDetails.name},on:{input:function(t){t.target.composing||e.$set(e.paymentOpt.CreditCardDetails,"name",t.target.value)}}})]),e._v(" "),e.cardHolderErrorMsg?r("v-flex",{attrs:{xs12:"",errorMsg:""}},[e._v(e._s(e.cardHolderErrorMsg))]):e._e()],1),e._v(" "),r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs7:""}},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.paymentOpt.CreditCardDetails.mm,expression:"paymentOpt.CreditCardDetails.mm"}],staticClass:"flex-3 br-0",attrs:{id:"expirationMonth_cc",maxlength:"2",placeholder:"MM",autocomplete:"cc-exp-month"},domProps:{value:e.paymentOpt.CreditCardDetails.mm},on:{keyup:e.checkMonthLength,keypress:e.onlyNumeric,input:function(t){t.target.composing||e.$set(e.paymentOpt.CreditCardDetails,"mm",t.target.value)}}}),e._v(" "),r("span",{staticClass:"flex-3 slash"},[e._v("/")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.paymentOpt.CreditCardDetails.yy,expression:"paymentOpt.CreditCardDetails.yy"}],ref:"expiryYrs",staticClass:"flex-3 bl-0",attrs:{id:"expirationYear_cc",maxlength:"2",placeholder:"YY",autocomplete:"cc-exp-year"},domProps:{value:e.paymentOpt.CreditCardDetails.yy},on:{keypress:e.onlyNumeric,input:function(t){t.target.composing||e.$set(e.paymentOpt.CreditCardDetails,"yy",t.target.value)}}})]),e._v(" "),r("v-flex",{attrs:{xs4:"","offset-xs1":"",prel:""}},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.paymentOpt.CreditCardDetails.cvv,expression:"paymentOpt.CreditCardDetails.cvv"}],attrs:{id:"cvv_cc",type:"password",placeholder:"CVV",autocomplete:"cc-exp-year",maxlength:e.cardMaxLength},domProps:{value:e.paymentOpt.CreditCardDetails.cvv},on:{keypress:e.onlyNumeric,input:function(t){t.target.composing||e.$set(e.paymentOpt.CreditCardDetails,"cvv",t.target.value)}}}),e._v(" "),r("img",{staticClass:"pabs cvv",attrs:{src:"/pwa/bus/static/img/icons/cvc_hint.png"}})])],1),e._v(" "),r("v-layout",{attrs:{row:"",wrap:""}},[e.cardExpiryDateErrorMsg?r("v-flex",{attrs:{xs8:"",errorMsg:""}},[e._v(" "+e._s(e.cardExpiryDateErrorMsg)+" ")]):e._e(),e._v(" "),e.cardCVVErrorMsg?r("v-flex",{attrs:{xs4:"","offset-xs8":"",errorMsg:""}},[e._v(" "+e._s(e.cardCVVErrorMsg)+" ")]):e._e()],1)],1):e._e(),e._v(" "),r("payment-error",{attrs:{showPaymentDialog:e.showPaymentDialog,paymentErrorMessage:e.paymentErrorMessage},on:{closePaymentError:function(t){e.showPaymentDialog=!1}}}),e._v(" "),e.showLoader?r("div",{staticClass:"ajax-loader"},[r("div",{staticClass:"sk-wave"},[r("div",{staticClass:"sk-rect sk-rect1"}),e._v(" "),r("div",{staticClass:"sk-rect sk-rect2"}),e._v(" "),r("div",{staticClass:"sk-rect sk-rect3"}),e._v(" "),r("div",{staticClass:"sk-rect sk-rect4"}),e._v(" "),r("div",{staticClass:"sk-rect sk-rect5"})])]):e._e(),e._v(" "),r("div",{staticClass:"pricefixed"},[r("button",{staticClass:"btn red",on:{click:function(t){return t.stopPropagation(),e.submitPay(t)}}},[e._v("\n            PROCEED TO PAY â‚¹"+e._s(e.totalPrice-e.redeemedamount)+"\n         ")])])],1)},staticRenderFns:[]}}});
//# sourceMappingURL=37.a3527ffd6bb706e9647b.js.map